マルチスレッドとマルチプロセス
========

Linuxにおけるマルチタスクの実装に関して。

結論
----

* マルチプロセスはプロセスをforkして、メモリ空間をコピーする。マルチスレッドはメモリ空間を共有する。従ってマルチスレッドの方が低コストと言われる。
* 構造としては、スレッドはプロセスの中に内包される形になる？ 1プロセス1スレッドではなく、プロセスを分割したのがマルチスレッド。
* 例えばapacheではマルチプロセスで動作する`prefork`と、マルチスレッドが組み合わされる`worker`から挙動を選択できる。

スレッドセーフ
----

各スレッド間で排他制御が適切に行われ、マルチスレッドでの動作が保証されているのが「スレッドセーフ」。あくまで「動作可能」の意味であり、マルチスレッドによる高速化をうたっているわけではない。例えばPHPにはTS（スレッドセーフ）とNTS（ノンスレッドセーフ）で別のバイナリになる。

参考
----

* [イケてるエンジニアになろうシリーズ 〜メモリとプロセスとスレッド編〜 - もろず blog](http://moro-archive.hatenablog.com/entry/2014/09/11/013520)
* [マルチスレッドのコンテキスト切り替えに伴うコスト - naoyaのはてなダイアリー](http://d.hatena.ne.jp/naoya/20071010/1192040413)