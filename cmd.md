辛いので出来る限り書きたくない。

基礎文法
----

### 変数

* 型はない。
* `set foo=bar`形式で代入する。
* 数式等評価させたい場合は`set /a sum=1+1`と`/a`オプションを用いる。

### 環境変数

* `%date%` : YYYY/MM/DD形式で現在日付を返す。
* `%time%` : HH:MM:SS.SS形式で現在時刻を返す（但しHHが1桁の場合、10の位は半角スペース）

### 文字列

* クォートは不要。`echo`でも`set`でも。
* 展開した変数を連結する場合も`+`などは必要とせず、愚直に並べるだけでよい。
* n文字目指定での切り出しが可能。以下、文字数lの文字列に対して実行した場合。語頭が0文字目。

|書式|意味|
| --- | --- |
|%V:~m%|m文字目～l文字目|
|%V:~m,n%|m文字目～m+n-1文字目|
|%V:~m,-n%|m文字目～l-n文字目|
|%V:~-m,-n%|l-m+1文字目～l-n文字目|
|%V:/=%|スラッシュを削除（イコールの左辺を右辺に置換）|

### 条件分岐

* if文を使用する。switch文は存在しない。
* 演算子は下記の通り。

|書式|意味|
|--|--|
|equ|等しい|
|neq|等しくない|
|lss|未満|
|leq|以上|
|gtr|より大きい|
|geq|以上|
|==|文字列が等しい|
|exist file|ファイルが存在する|

* 構文は下記の通り。
* 直前の処理の結果確認に使える`if ERRORLEVEL 1 ()`構文があるが、
  ERRORLEVELが **1以上** の場合にtrueとなるので注意。

```dosbatch
if [not] 条件 (
  true
) else (
  false
)
```

### 繰り返し

* 基本構文は`for %i in (set) do command`だが、オプションがいろいろありすぎる。
* バッチファイルで実行する場合は`%%i`と2つ重ねる。

```dosbatch
REM 基本構文のsetは配列のように機能する
for &i in (foo bar baz) do @echo %i
REM /Lでいわゆるインクリメントでのfor
for /L %i in (0,1,10) do @echo %i
REM /Fで文字列やコマンドの実行結果で繰り返し
for /F %i in ('dir /ad /b /w') do rmdir /s /q %i
for /F "eol=; tokens=2,3* delims=, " %i in (myfile.txt) do @echo %i %j %k
```

コマンド
----

* `eventcreate /l system /id 0 /t error /so "source" /d "description"` : イベントログ作成

こんなときは？
----

### スクリプト内で別のスクリプトを呼ぶ

* `foo.bat`のように直書きして使うと、呼んだ先のスクリプトが終了した時点で処理を終えてしまう。
* `call`を使う。呼んだ先のスクリプトの終了を待って以降の処理が継続する。
* `start`を使う。呼んだ先のスクリプトは待たずに処理が継続する。

### echoで改行する

* logで空行を入れたいときなどに。
* `echo`直後の文字が無視される性質を利用する。

```bat
echo. > sample.log
```
