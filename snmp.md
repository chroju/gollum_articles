記事
====

* [[snmpで任意の値を出力する]]

概要
========
* 主にネットワーク機器等、遠隔にあるハードウェアの状況監視に使用するプロトコル。
* マネージャー、エージェント構成であり、マネージャーからのリクエストに応じてエージェントが情報を返す場合と、エージェントが自ら情報を通知する（トラップ）がある。後者は障害検知等で用いる。
* 使用ポート番号はリクエストのdestが161、トラップのdestが162。


リクエスト
----
* リクエストによる機器情報の取得には、**MIB**と呼ばれるツリー構造の情報集合体が用いられる。
* MIBには規格化された**標準MIB**と、各ベンダーごとの独自実装にあたる**拡張MIB**が存在する。
* 機器情報ではなく、回線の状態を監視した情報は特に**RMON**と呼称されるMIBにあたる。
* 無制限にリクエストに応答してしまい、情報が漏洩することは好ましくないため、**SNMPコミュニティ**と呼ばれるグループによってリクエスト可能なサーバーを限定したり、送信元IPに応じて権限を与えることができる。（従ってコミュニティ名は「パスワード」に近い役割を持つ）


トラップ
----
* 機器で送信先IPアドレスを指定し、トラップを上げさせる。
* トラップはSNMP v1では「トラップ番号」、SNMP v2では「OID」により分類されており、リンクダウンや機器の再起動の他、ベンダー固有の情報も上げることができる。基本的には、この中で必要な情報だけを選んで送信させる。

Commands
========

snmpwalk
----

```bash
$ snmpwalk -v 2c -c community hostname OID
# 全件取得（※かなり多いので注意）
$ snmpwalk -v 2c -c community hostname .
```

snmptranslate
----

OIDをMIB名に変換してくれる。

```bash
$ snmptranslate OID
```

参考
==================================================
* [TCP/IP - SNMPとは](http://www.infraexpert.com/study/tcpip21.html)
* [SNMPによるネットワークモニタリング「第2版」：第8回　SNMPによる異常値検出テクニック (1/7) - ITmedia エンタープライズ](http://www.itmedia.co.jp/enterprise/articles/0705/31/news042.html)
* [セキュリティ対策の「ある視点」（10）：SNMPコミュニティ名、そのデフォルトの価値は (1/4) - ＠IT](http://www.atmarkit.co.jp/ait/articles/0807/01/news167.html)
* [snmpでlinuxのdisk パーティション監視 - うまいぼうぶろぐ](http://hogem.hatenablog.com/entry/2015/09/26/233000)
  * snmpで目的の情報を取るまでってこうやるんだぜという参考に。